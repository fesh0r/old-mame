0.122u5
-------


MAMETesters Bugs Fixed
----------------------
scorpion0111u5gra [couriersud]
qbert37b14gre1 [Zsolt Vasvari]
blktiger060gre [robiza]
kinstc081u7gre [Aaron Giles]
kinst2083gre [Aaron Giles]
umk3059gre [Aaron Giles]
umk3137b5gre [Aaron Giles]
lasso056gre_1 [Zsolt Vasvari]
lasso056gre_2 [Zsolt Vasvari]
term20103u4gre [Aaron Giles]
term20104u2gre [Aaron Giles]
m72_0115u3yel [Mamesick, Aaron Giles]
deadang0119u2red [David Haywood]
tmnt095gre [Zsolt Vasvari]
memleak0122u2ora [Atari Ace]
junglek055gre [Zsolt Vasvari]



Source Changes
--------------
Fixed flipped tilemap offset for scramble and clones (playable 
cocktail mode). [couriersud]

Changed Exidy driver to draws the background directly from memory 
avoiding having to decode the gfx repeadately. [Zsolt Vasvari]

Added machine and cpunum parameters to INTERRUPT_GEN callbacks. Fixed 
several places that were not using INTERRUPT_GEN or OPBASE_HANDLER 
macros. [Atari Ace]

Minor bugfixes to the gfxlayout cleanups included in u4. [Atari Ace]

Added code to debug 64-bit builds to allocate all address space below 
4GB to help find 64-bit errors. Added environment variable 
OSDDEBUGMALLOC which, if set, explicitly overrides the debug malloc 
debug settings. Added environment variable OSDDEBUG4GB which, if set, 
explicitly overrides the new 64-bit address space allocations. (Sadly 
this is necessary due to some D3D drivers being 64-bit unclean....)
[Aaron Giles]

Fixed winwork to use proper tchar functions for getenv. [Aaron Giles]

Fixed bug where the 64-bit DRC was not saving rbp. [Aaron Giles]

Cleaned up the lasso driver. [Zsolt Vasvari]

Simplified Y-unit DMA rendering, fixing bugs and removing the macro
voodoo. [Aaron Giles]

Removed a bunch of dead code from othunder.c. [Zsolt Vasvari]

Implemented proper video timing and scanline interrupts in the m72
driver. [Mamesick, Aaron Giles]

mario.c improvements: [couriersud]
 * discrete sound
 * hooked up z80dma
 * combined memory maps
 * statics in mario_state struct
 * fixed save state issues
 * combine sh_* writes into one routine

audio/dkong.c: [couriersud] 
 * fixed LS123 constant to match TI datasheet diode circuit constant

TX-1 improvements [Philip Bennett, Guru]:
 * Fixed remaining arithmetic unit issues
 * Added correct object colour pixel LUT PROM to tx1a
 * Fixed x-flipping
 * Added engine sounds

Added correct DIP switch settings for Big Fight. Also corrected Cycle 
Warriors DIP switches. [Philip Bennett]

Changed and verified frequencies on Ikari Warriors h/w, Tnk3, Hyper 
Sports, Jackal and S.A.R. [Corrado Tomaselli]

Verified and corrected a lot of frequencies and oki6295 pin 7 on pcbs:
Double Dribble, Chequered Flag, Diet gogo, Boulderdash, Sly Spy, 
Psycho Nics Oscar, Captain Silver, Magical Cat Adventure, Raiden, 
Superman, Twin Hawk, Vimana, Ghox, Dogyunn, truxton2, Pipi and Bibis, 
Fix Eight and Money Money. [Corrado Tomaselli]

Cleaned up brkthru/darwin memory maps. Changed both games to use 
identical video timing parameters based on measurements of darwin.
Guessed based on available information at the master clock and 
derived all game clocks from it. [Aaron Giles]

Reogranized and started to clean up the CVS driver. Added emulation
of the speech CPU. Removed CVS BIOS entry. Removed unnecessary 
patching. [Zsolt Vasvari]

sauro.c: [couriersud]
 * Hooked up sp0256 sound
 * analyzed and commented some ports
 * added palette_bank support without real success

Reorganized the Raiden 2 driver.. a bit of extra documentation of the 
'V33' based set, which has been renamed. Nothing new working.
[David Haywood]

Fixed scan functions for kickgoal background, which were swapped.
[David Haywood]

Fixed 2650 disassembly of the sense and flag bits. Fixed incorrect
argument order in OUT instruction. Corrected spacing. [Zsolt Vasvari]

Fixed hang/crash on empty config file. [Wilbert Pol]

Cleaned up tceptor memory maps. [Zsolt Vasvari]

Atari System 2 driver cleanup: [Aaron Giles]
 * Proper video timing.
 * Full memory maps.
 * Save state support.
 * Removed 720 sound CPU hack in favor of prepopulated EEPROM like 
    the other games.

Added support for outputting 64-bit target addresses in the i386dasm.
[Aaron Giles]

Added MESS PC-Engine emulatation system. Fixed MAME debug build under
VC2003. [David Haywood]

Unified memory maps in tmnt.c and twin16.c. Reversed ROM set names 
of Cuebrick World and Japan versions. Changed some function names to 
reflect parent set. [Zsolt Vasvari]

Changed Konami drivers to allocate and decode graphics using the same
layouts. Removed the layout parameter from the decodechar() calls.
[Atari Ace]

Fixed C++ compilation errors. [Dave Dribin]

Made INPs compatible between 64-bit MAME and 32-bit MAME. [Chad]

Complete taitosj memory map from Nicola's ancient notes. General code 
clean-up. [Zsolt Vasvari]

src2html improvments: [Aaron Giles]
 - added line numbers
 - added link to the raw file if the src and dst dirs are the same
 
"Fix" for full screen switch, which makes no sense, but is included
based on empirical evidence that is somehow works. [Emuman]



New games added or promoted from NOT_WORKING status
---------------------------------------------------
Name Club Ver.3 (J 970723 V1.000) [David Haywood]
Blazing Lazers [David Haywood, Charles MacDonald, Mr. Do]



New clones added
----------------
Lead Angle (Japan) [Guru]
A Question of Sport (39-960-107) [Highwayman]
Gee Bee (F.lli Bertolino license) [Corrado Tomaselli]



New games marked as GAME_NOT_WORKING
------------------------------------
Road Runner (Midway) [Zsolt Vasvari, Guru]
Paranoia [David Haywood]



0.122u4
-------


MAMETesters Bugs Fixed
----------------------
gui0121u1gre [Aaron Giles]
drivedge0121u4gre [Aaron Giles]
bking3076u2red [Pierpaolo Prazzoli]
btoads0102u5gre [Aaron Giles]
btoads0103u1gre [Aaron Giles]
editableui0120u4red [Aaron Giles]
cheat0118red [Aaron Giles]
altf4_0111u4gre [Aaron Giles]
beastrzb097u2red [Oliver Stoneberg]
memoryleak0118u1ora [Oliver Stoneberg]
memory_leak0111u6ora [Oliver Stoneberg]
mahoudai0106u7yel [Philip Bennett]
gridiron079gre [David Haywood]
maniach37b11gre [David Haywood]
matmaniac37b14gre [David Haywood]
qzkklgy2_0106u6red [David Haywood]
warriorb0109u2gre [David Haywood]
vball071u1gre [Bryan McPhail]
d3dwindow0117u3red [Aaron Giles, Emuman]
arkanoid061gre [Bryan McPhail]
flkatck058gre [David Haywood]
memleak0119u3ora [Oliver Stoneberg]
system24_0120u3red [Atari Ace, Aaron Giles]
aleck64_0120red [Aaron Giles]
mtetrisc0115u1red [Aaron Giles]
suratk0122u3gra [Pierpaolo Prazzoli]
suratk0122u3ora [Pierpaolo Prazzoli]
skychut37b1yel [couriersud]
skychut37b6gre [couriersud]
darius2_0114gre [Bryan McPhail]
ad2083_0111u5gra [couriersud]
abaseb0122u3red [Zsolt Vasvari]
ladybug080u1gre [Zsolt Vasvari]
suprridr0122u2gra [Zsolt Vasvari]
invho2_0122u3red [Zsolt Vasvari]
narc37b16yel [Aaron Giles]
kingofb37b6gre [robiza]
stonebal0117u2gre [Aaron Giles]
wotw36b1gre [Zsolt Vasvari]
wallst071gre [Zsolt Vasvari]
mtrap37b14gre [Zsolt Vasvari]
pitfight0109u2gre [Aaron Giles]



Source Changes
--------------
Corrected btoads clocks according XTALs on the PCB. [Aaron Giles]

"Simplified" MC8123 decryption, though it's still more complicated 
than I'd like it to be. [Nicola Salmoria]

Cleaned up clocks in the itech32 driver. [Aaron Giles]

Added partial key for FD1089B 317-0037. [Nicola Salmoria]

Fixed bking3 clocks as per Guru readme. Added GAME_WRONG_COLORS flag 
to bking3. [Pierpaolo Prazzoli]

TMS34020 fixes: [Aaron Giles]
 * Allowed 32-bit pixel sizes
 * Fixed RPIX instruction

Added new function input_poll_keyboard_switches to poll for only key 
events. Expanded the size of the maximum simultaneously pressed 
switches. [Aaron Giles]

Removed GAME_IMPERFECT_GRAPHICS from all jpmimpct games bar Cluedo 
(see driver note). [Philip Bennett]

mario driver improvements: [couriersud]
 - Hooked up flipscreen
 - Changed monitor orientation to ROT0

Added Z80 DMA chip [couriersud]
 - only implements intelligence to emulate dkong3
 - fixed a misleading comment in 8257dma.h

dkong driver improvements: [couriersud]
 - hooked up z80dma
 - removed 2nd player inputs from sdbk input_ports
 - fixed some dump "copy/paste" bugs in dip locations

Added redumped Turkey USA to the seta2.c driver. [Brian Troha]

Fixed bad ram pages errors in stactics service mode. 
[Pierpaolo Prazzoli]

Atari updates: [Aaron Giles]
 - Added save state support to slapstic.
 - Added save state support to YM2413.
 - Modified slapstic code to support address range mirrors.
 - Cleaned up Rampart driver:
    - simplified rendering code
    - full memory map
    - added save state support

Implemented decent-sounding FM in the SCSP. [kingshriek]

Updated Naomi driver, now boots and shows some test menus (press F2 
to get into test, use 9 to navigate). Also hooked up ROM board PIO 
and skeleton for DMA. [R. Belmont, Samuele Zannoli, ElSemi]

N64 improvements: [SGINut]
 - Move texture masking to occur after coordinate adjustment
 - Fix 32-bit texturing in load_tile (Mario Kart 64 title screen)
 - Add zero-alpha early-out (Mario 64 trees/stars, Mario Kart 64 
    trees/karts)

ad2083 improvements: [couriersud]
 * completed tms5110A code
 * working speech synthesis
 * documented analysis done on pcb pictures and findings
 * as a consequence, marked all sound roms as BAD DUMP
 * created sound driver in scramble.c

Cleaned up graphics layouts in preparation for new format. Added new
GFXLAYOUT_RAW() macro to normalize definition. Added new validation
code. Made all remaining instances of gfx_layouts const. [Atari Ace]

Updated Amiga driver to use formal XTALs. [Dirk Best]

Changed 6522 emulation such that when writing to the ACR register with 
the timer 1 in continuous counting mode, the timer 1 value should not 
be reloaded but keep on counting. [Wilbert Pol]

Added XTAL defines to bfm_sc2.c and cleaned up lvcards.c. 
[James Wallace]

Added default layout to neogeo games allowing for either cropping or
stretching to the alternate 304x224 layout. Removed default cropping
in the driver. [David Haywood, Aaron Giles]

Fixed crash when saving state of older DCS-based games. Added save 
state support to the midvunit driver. [Aaron Giles]

Major improvements to Cycle Warriors video code (still not perfect, 
but road layer works now). [Bryan McPhail]

Major rewrite of skychut.c. There are still some glitches and it is 
not perfect but the following has been achieved: [couriersud]
 * adds samples to ipm invaders - just rename your old invaders 
    samples to ipminvad to test
 * added - amongst others - "capsule" dip switch to ipm invaders
 * sound ports identified
 * demo sound and cabinet type driver configuration

Updated memory configuration for Superboard game versions in peplus
driver. Fixes CMOS DATA errors on reload. [Jim Stolis]

Rewrote the CVS system video code. [Zsolt Vasvari]

Fixed S2650 register window display. [Zsolt Vasvari]

Added sound to Cycle Warriors and Big Fight. Corrected OKI M6295 
clock values. [Philip Bennett]

Fixed missing arrow in Venture on the zoomed out map, and the 
incorrect fading twister in Hard Hat. [Zsolt Vasvari]



New games added or promoted from NOT_WORKING status
---------------------------------------------------
Dangerous Curves [Philip Bennett, Dazzer]
Big Fight [Bryan McPhail]



New clones added
----------------
Invasion - The Abductors (version 5.0) [Brian Troha]
Alien Syndrome (set 5, System 16A, FD1089B 317-0037) [Nicola Salmoria]
Dragon Spirit (Atari license) [Satoshi Suzuki]



0.122u3
-------


MAMETesters Bugs Fixed
----------------------
hstennis0103u2gra [Brian Troha]
edrandy0113gra [Brian Troha]
robocop2_0106u3gra [Brian Troha, Bryan McPhail]
mario0110u1gre [couriersud]
sbrkout0118yel [R. Belmont, Adam Bousley]
pestplce0122red [couriersud]
funkyjet055yel [Bryan McPhail]
liberate074u1gre [Bryan McPhail]
tokiu056gre [Bryan McPhail]
powerbls0112u4red [Pierpaolo Prazzoli]
wwestern0115u1yel [Atari Ace]
namcos1_0118u2yel [Atari Ace]
victnine0116u2red [Pierpaolo Prazzoli]
btoads0103gre [Aaron Giles]



Source Changes
--------------
Fixes clocks for Orbs. [David Haywood, Tomasz Slanina]

Fixed various 64-bit GCC warnings. [R. Belmont]

Improves accuracy and documentation of NSS/SNES DSP-1.
[Andreas Naive, R. Belmont]

Added new file xtal.h, documenting all known arcade PCB clock cystals.
Drivers should be updated to use these as a basis for their clocks,
and the list should be augmented as additional crystals are found.
[Guru, Aaron Giles]

suprloco improvements: [Pierpaolo Prazzoli]
 * Fixed IC.34 memory test 
 * Fixed 2nd player cocktail mode
 * Changed coin3 to service1
 
Cleaned up inputs/DIP switches in cninja driver. [Brian Troha]

Rewrote mario.c: [couriersud]
 - rewrote driver, separate MACHINE_DRIVER(mario_audio)
 - palette from schematics
 - video timing from schematics
 - driver configuration switch Nintendo/Std Monitor
 - got rid of COLORTABLE

Fixed typo for IO1 irq callback in hyperstone core. 
[Pierpaolo Prazzoli]

Added memory_get_bank() function. Fixed logging in memory.c to to use 
%p for pointer values. [Aaron Giles]

Fixed save states in i8051 cpu core [Pierpaolo Prazzoli]

Implemented a few SysCtrl, Maple, and PVR/HOLLY bits for Naomi. The 
BIOS gets slightly further but is nowhere near starting up. 
[R. Belmont]

Zeus updates: [Aaron Giles]
 * Better documented various bit latches.
 * Hooked up crusnexo lamp board (added layout).
 * Fixed year in MK4 startup test.

Fixed TMS5110 tables. [couriersud, Lord Nightmare]

Removed ui_popup(). Drivers should always be using popmessage() 
instead (has been this way for a while). Augmented popmessage() so 
that you can pass NULL to immediately dismiss any messages.
[Aaron Giles, thanks to Oliver Stoneberg's suggestion]

Added ATTR_PRINTF to a number of functions that have printf semantics.
[Oliver Stoneberg]

Rewrote sbrkout driver based on schematics: [Aaron Giles]
 * XTAL-based timing
 * Correct video timing
 * Full memory map
 * Correct memory usage ("zero page" RAM is shared with videoram)
 * Removed all input hacks
 * Fixed interrupt generation
 * Connected coin counters
 * Added save state support

Fixed several UNICODE=1 issues in the debugger. Changed the Windows
build process to always enable UNICODE=1 for 64-bit builds.
[Oliver Stoneberg, Aaron Giles]

Added save state support to btoads. [Aaron Giles]

Fixed onna34ro mcu simulation properly. [Pierpaolo Prazzoli]



New clones added
----------------
Mutant Fighter (World, EM-3) [Stefan Lindberg]
The Simpsons (2 Players Asia) [Arzeno Fabrice]



0.122u2
-------


MAMETesters Bugs Fixed
----------------------
pestplce0122red [couriersud]
hunchbkd0122red [couriersud]
radarscp0122yel [couriersud]
mwalk0122red [couriersud]
qtheater0122u1ora [Philip Bennett]



Source Changes
--------------
Fixed M65C02 optimization. [Peter Trauner]

TMS51xx and M58817 speech updates: [couriersud]
 - radarsc1 uses tms5110 speech synth
 - cvs games: according to PCBInfos speech chip is TMS5100.
    Changed driver to use TMS5100 and "game system operational" now 
    sounds more natural
 - removed sound/m58817.*
 - added support for multiple coefficients maps to tms5110.*
 - added coefficient maps for TMS5100 and M58817 from documented 
    sources to tms5110r.c
 - fixed interpolation factors (see tms5110r.c for reason)
 - made lattice calculation precision 9bit
 - added support for READBIT and LOADADDRESS commands to tms5110.c
 - more changes in line with various patents
 - documented TRS-02, TKG-02/03 "voice" interface

Completed the addition of static qualifiers to all MAME symbols that 
aren't explicitly exported. [Atari Ace]

Named the input_seq_type enumeration and used it explicitly in several
places. [Nathan Woods]

Corrected tx1 and tx1a coinage DSW assignments. Reversed buggyboy/
buggybjr 'Game Time' settings. [Philip Bennett]

TMS3203x core updates: [Aaron Giles]
 * fixed interrupt handling
 * added support for edge-triggered interrupts on '32
 * expanded interrupt support for the '32
 * updated drivers using TMS3203x core to deassert interrupts
 * added externally accessible functions for converting '3x floating point 
    format
 * updated gaelco3d driver to use new functions

Zeus2 (+related) updates: [Aaron Giles]
 * fixed save states for DCS games
 * cleaned up Zeus2 waveram handling
 * added Zeus2 save state support
 * added preliminary model and quad rendering support for Zeus2
 * added support to timekpr for the ZPRAM used on Zeus2
 * hooked up ZPRAM in Zeus2 games
 * hooked up controls in Zeus2 games
 * updated poly.c to ensure it is idle before saving state
 * Added artifical Z offset of -2 to make the full screen show in crusnexo

Replaced tekken2/tekken2a/tekken2b 'tes1wave.8k' ROM with the 
correct, non-byte-swapped dump. [Philip Bennett]

Added discrete 74LS624(56789) implementation [couriersud]
 - DISCRETE_74LS624 is a VCO needed for dkongjr
 - Supports Logic, Energy and Count outputs

dkong updates: [couriersud]
 - Added dkongjr discrete sound
 - Proper interface Z80 - I8035 for dkongjr
 - Changed discrete sound output factors
 - removed samples support for dkongjr
 - Cosmetic changes
 - Fixed regression in radarscp sound
 - Added dipswitch locations to dkong3b

Documentation and clock frequency improvements for seta.c: [Brian Troha]
 - Added the Guru's readme info for Thundercade
 - Corrected rom name for Thundercade
 - changed clocks to OSC by divider IE: 16000000/2 /* 8MHz */
 - Changed Orbs clock to 16MHz with note about 14.xx MHz
 - Changed Meta Fox's x0-006 (65c02) to same as Thundercade
 - Changed the YM3438 in Ultra Toukond Densetsu from 6MHz to 1600000/4 
    /* 4MHz */ as there is no mention of 6MHz OSC on PCB

Verified a number of clock frequencies from real PCBs.
[Corrado Tomaselli, Zsolt Vasvari]

Fixed several memory leaks related to SCSI CD emulation.
[Oliver Stoneberg]

Removed the increasing of the R register from each IX/IY related 
(FD xx or DD xx) instruction on the Z80. According to documentation
and the behavior of the Amstrad CPC driver, this is incorrect.
[Barry Rodewald]

Added initial FPU support to the SH4 core. [Samuele Zannoli]

Adjusted most conditional logging in MAME to use the idiom 
"do { if (VERBOSE) logerror x; } while (0)". This has the benefit that 
the compiler checks the syntax of the logging even in the case it will 
be eliminated, and in fact a number of cases here needed adjustments 
to compile because of this. [Atari Ace]



0.122u1
-------


MAMETesters Bugs Fixed
----------------------
ym2610_0119u2gre [Philip Bennett]



Source Changes
--------------
Zeus updates: [Aaron Giles]
 * Figured out data format of 2 matrix form.
 * Extracted data for lights.
 * Added backface culling which mostly works but fails sometimes, so 
    it is disabled.
 * Started on some initial lighting calculations.
 * Cleaned up zeus wave RAM accessors.
 * Changed rendering code to allow for greater parallelism on multicore
    systems.
 * Removed some vestigial zeus 2 hacks.
 * Reduced visible area to remove artifacts.
 * Made right/bottom vertices inclusive to fix some gapping issues.
 * Fixed invasn lightgun offset.

Zeus 2 hardware:
 * Fixed ROM loading, added banking support.
 * Separated zeus 2 video implementation from zeus implementation.
 * Implemented direct pixel accesses; enough to get startup screens 
    to show.
 * Hooked up ZPRAM.
 * Fixed digital inputs for crusnexo.
 * Fixed default screen parameters to match the games.

Afega/nmk16 cleanups: [David Haywood, Tomasz Slanina]
 * Merged afega.c and nmk16.c drivers
 * Removed many hacks from both.
 * Fixed a number of games

Fixed C219 sample read order and implemented sign+magnitude format.
Removed GAME_IMPERFECT_SOUND flag from all Namco NA-1 games.
[Philip Bennett]

Fixed ROM-based DCS2 system to ignore HLE transfers. (Fixes broken 
sound in invasn.) Properly reduced internal memory on the ADSP-2104 
variants. [Aaron Giles]

Fixed bug that would cause events to leak through to the game when the 
debugger was up. [Aaron Giles]

Verified some cpu clocks of original boards using a frequency counter:
[Corrado Tomaselli]
 * Changed Success Joe Ym2203 clock from 3mhz to 4mhz
 * Changed Pang M6295 clock from 990khz to 1Mhz
 * Changed Halley Comet main cpu clock to 1.664mhz (it's not a 
    mistake, the clock is very low)
 * Besides confirming clocks on some games, I modified:
 * Aerofighters and Turbo Force sound z80 to 5mhz
 * Midnight Resitance 68k cpu to 10mhz (20mhz crystal) and modified 
    m6295 clock to 1mhz. Also confirmed pin 7 is high.
    (Midnight resistance has a lot of slow downs on the pcb too)

Minor "code quality" improvements: [Atari Ace]
 * fixed some remaining static/const qualifier missed cases
 * fixed some missing #include "foo.h"
 * a few global names were modified to make them less generic/more 
    consistent (voodoo.c, vrender0.c, lethal.c, rungun.c, zac2650.c)
 * some dead/useless code was removed (i8051.c,model1.c,romcmp.c)



New games added or promoted from NOT_WORKING status
---------------------------------------------------
Invasion [Aaron Giles]
Buggy Boy Junior/Speed Buggy (Upright) [Philip Bennett]
Task Force Harrier [David Haywood, Tomasz Slanina]
US AAF Mustang [David Haywood, Tomasz Slanina]
Black Heart [David Haywood, Tomasz Slanina]
Red Hawk [David Haywood, Tomasz Slanina]
Stagger I [David Haywood, Tomasz Slanina]
Sen Jin - Guardian Storm [David Haywood, Tomasz Slanina]
Spectrum 2000 [David Haywood, Tomasz Slanina]
Fire Hawk [David Haywood, Tomasz Slanina]



New clones added
----------------
World Class Bowling (v1.3) [Brian Troha]
