0.128u3
-------


MAMETesters Bugs Fixed
----------------------
- 02633: [Crash/Freeze] Many sets using the MC6845: Crash/hanging in 
         many games. (Curt Coder)
- 02626: [DIP/Input] crimfgt2, crimfgtj: Cannot start a game 
         (Fabio Priuli)
- 02618: [Sound] samuraia and clones: No SFX sound 
         (Pierpaolo Prazzoli)
- 02544: [Core] Dip Condition / Port Include limitation (Aaron Giles)
- 02542: [DIP/Input] ghoulsu: Doesn't remove the original port when 
         replacing it with a conditional port (Aaron Giles)
- 02607: [Crash/Freeze] frogs: Taking a screenshot in Frogs (Gremlin) exits the game with an error. (aaron)



Source Changes
--------------
Changed 74123 into a device. Clarified behavior from datasheet. Added
logic to avoid recursive calls. [couriersud]

Fixed Dip Switches for all games in halleys.c driver.
Added Dip locations for 'halleys' and clones. [stephh]

More improvements to the 32x code. [David Haywood]

Irem M10: first results from schematics: [couriersud]
 * Updated video timing and cpu/pixel clocks
 * Rewrote irq for m10/m11 to use two 74LS123

AICA: fix missing instruments in DTPK driver games.
[R. Belmont, Deunan Knute, kingshriek]

Naomi: unmapped words in the AICA address range must read as zero.
[R. Belmont]

Corrected YM2203 balance in powerins. [Jim Hernandez]

Converted toobin to RGB32 to allow for mid-screen palette updates.
Also added correct video timing and full memory map, and connected
watchdog. [Aaron Giles]

Added Dip locations for 'exprraid' and clones, and for 'gyruss' and 
clones. [stephh]

Hooked up 6845 to peplus driver: [couriersud]
 * Hooked up 6845 in a daisy chain way into existing "6845 emulation"
 * Clocks from schematics
 * Video size issues - 6845 code related, discussion started on list

Re-inlined core attotime functions. This makes a significant 
difference when running with high interleaves. [Aaron Giles]

Added support for recently-discovered internal Z80 register to the
Z80 core. Improves accuracy of undefined flags. [Miodrag Milanovic]

Reverted MC6845 changes as they broke a number of things. [Curt Coder]

Converted Z80, R3000, ADSP2100, and M680x0 cores to reference their
data via pointers instead of global structs, in anticipation of
future changes. [Aaron Giles]

Fixed coinage in Speed Attack! and cleaned-up the driver to current 
standards. [Angelo Salese]

Converted the MCS-48, MCS-51, and m6502 cores to reference data via 
pointers. [couriersud]

Added concept of scheduling quanta to the timer system. Also added
means of setting the minimum useful scheduling quantum, and clamping
all quanta to that value. [Aaron Giles]

Changed interleave/boost handling to use scheduling quanta instead
of timers. [Aaron Giles]

Added machine parameter to cpu_boost_interleave. [Aaron Giles]

Updated cpuexec to compute the "perfect" interleave value taking into
account the minimum number of cycles per instruction specified by the
CPU core. Updated Z80 core to indicate that the minimum cpi is 2. 
Fixed incorrect minimum cpi in the 68020+ cores. [Aaron Giles]

Changed core cycle computations to use div_64x32 instead of full 
64-bit divides. This involves tossing a few bits of resolution at 
divide time, but should make no real difference in practice.
[Aaron Giles]

Began the process of pruning options from the 68000 core, hard-coding 
it for MAME's needs. We've hacked on it sufficiently that it is no 
longer generic, so this is a good opportunity to simplify the code 
so that it can actually be followed (still in progress). [Aaron Giles]

Defined macros for all core CPU functions, along with macros for the 
name and for calling, in the spirit of the devintrf.h macros.
[Aaron Giles]

Changed init, reset, exit, and execute interfaces to be passed a
const device_config * object. This is a fake object for the moment,
but encapsulates the machine pointer and token. Eventually this will
be a real device. [Aaron Giles]

Changed the CPU IRQ callbacks to a proper type, and added a device
parameter to them. [Aaron Giles]

Fixed background color of srmp1/srmp2. [EdxGROfS0]

Various improvements in the ST-V driver: [Angelo Salese]
 * Fixed bitmap zooming in Virtual Mahjong 2 - My Fair Lady;
 * Worked around a major graphic bug in ElanDoree;
 * Added some missing alpha blending effects,Pro Mahjong Kiwame S 
    title screen needs it but it doesn't work yet due to other 
    problems (still investigating)
 * Fixed a crash bug with Astra Super Stars when the debugger is 
    active.

Merged DS5002FP into MCS51: [couriersud]
 * Merged DS5002FP
 * Disassembler now uses type specific memory names
 * Merged DS5002FP disasm
 * added 83C751 memory names to disassembler
 * delete DS5002FP specific files
 * removed unnecessary cpu callback in wrally
 * DATA_MAP ==> IO_MAP in wrally

Continued rewrite of the Motorola DSP56k CPU core:
[Andrew Gardner, PhilB, RBelmont]
 * Added proper clock speed to plygonet.c and internal divider to 
    dsp56k.c
 * Fixed up disassembler add/sub, 05xx, and bsr ops.
 * Handle mysterious uuuuF instruction found in plygonet add op.
 * Partially implemented add, sub, mac, mpy, inc, cmpm, macr, asr16, 
    jscc, lea, and movec ops.
 * Added dual X memory read and data move with short displacement 
    parallel moves.

Some improvements to the Forte Card driver, not yet working.
[Angelo Salese]

Changed Psicho Nics Oscar (japan revision 0) to (world revision 0)
since there is no japan disclaimer. [Corrado Tomaselli]

Fixed missing inputs in expro02. [Sonikos]

CPS2 ROM updates to match PCB labels. [Razoola]

Added ADDRESS_MAP_NAME macro, updated CPU cores to use it to reference
internal address maps. [Atari Ace]

Added include files for many drivers that never bothered before.
[Atari Ace]

Improved Star Castle drone sound. [Jim Hernandez]



New games added or promoted from NOT_WORKING status
---------------------------------------------------
Snezhnaja Koroleva [Antro]



0.128u2
-------


MAMETesters Bugs Fixed
----------------------
- 02268: [Graphics] devilw, darkadv, majuu : Sprite-background 
         priority isn't correct. (Mamesick)
- 02042: [Color/Palette] jjparad2: Wrong background color (Mamesick)
- 01679: [Crash/Freeze] kuniokub, kuniokun, renegade: Game freezes 
         after Title Screen. (Mamesick)
- 00224: [Sound] macross2: After stage 1, the sound keeps going out 
         and coming back. (Nicola Salmoria)
- 02605: [Color/Palette] funnymou, suprmous: Wrong colors in Funny 
         Mouse and clone. (David Haywood)
- 02587: [Gameplay] lohtb2: lohtb2 protection emulation is imperfect 
         (couriersud)
- 02456: [Core] wrong sector size at CD_TRACK_MODE2 conversion routine
         (R. Belmont)
- 02011: [Sound] superchs: ES5505 clockspeed too low (Phil Bennett)
- 02199: [DIP/Input] banbam, pettanp: The 4th 'Unused' dipswitch is 
         the 'Freeze' switch. (Angelo Salese)
- 00893: [Sound] All games in playch10.c, punchout.c, vsnes.c: It 
         seems that some sound channels are missing. (Aaron Giles)



Source Changes
--------------
Added sound banking to the mirage.c driver. [Angelo Salese]

Removed parent clone relationship from "Street Fighter Zero/Alpha 2" 
and "Street Fighter Zero 2 Alpha". [David Haywood]

Removed parent clone relationship between missb2 and bublbobl. We 
don't usually make the 'korean hacks' as clones as they have very 
little to do with the original releases except for the stolen cpu 
code. GFX / Sound / Gameplay are completely redesigned. 
[David Haywood]

Changed VBLANK to irq0_line_assert and added a CLEAR_LINE in the
peplus driver. This greatly increases speed on all video slots.
[Jim Stolis]

Cleaned up the sample rom loading in mirage.c. [Angelo Salese]

MCS-51 improvements: [couriersud, Jim Stolis]
 * Fixed split timer mode
 * No interrupts for timer 0 modes 0,1,2 while timer 1 in mode 3
 * mcs51 core now supports 4 interrupt levels depending on cpu type
 * According to Philips, 80C31 is a 80C52 family member with 128K 
    internal ram and no rom
 * Implemented cmos features: powerdown & idle
 * Added comments about special function registers on Philips 80C52
 * cleaned up reset routines
 * Fixed INT0 & INT1 interrupt line handling
 * Finally move cpu/i8051 to cpu/mcs51, rename files and some 
    constants
 * Quotes from the documentation added to the source as well
 * Started DS5002FP integration

Updated nes pcm dma to read data through the cpu address map.
[Wilbert Pol]

Fixed Dip Switches for 'ambush' and clones. [stephh]

Improvements to magicfly driver: [Roberto Fresca]
 - Added sound support to magicfly and 7mezzo.
 - Hooked coin counters to magicfly and 7mezzo.
 - Inverted the graphics banks to be straight with the hardware accesses.
 - Updated the memory map description and technical notes.
 - Added game notes and documented the test/settings/bookkeeping modes.

Fixed Dip Switches for 'arabian' and clones. [stephh]

Fixed Dip Switches for 'spaceint' and clones. [stephh]

Fixed MSM5205 ADPCM and sound comms in Ashita no Joe/Success Joe.
[Philip Bennett]

Changed superchs ES5505 clock rate to 15238050Hz. [Philip Bennett]

Fixed Dip Switches for all games in astrof.c driver. [stephh]

Various improvements to the jalmah.c driver: [Angelo Salese]
 * Fixed tilemaps paging / tilemap positioning;
 * Fixed a protection issue in Mahjong Daireikai,not giving correct 
    colors for the girls in-game;
 * Fixed a rom-loading issue in Mahjong Daireikai;
 * Fixed 'ZA' sound banking behaviour,this fixes at least the sound 
    in kakumei2;
 * Removed VIDEO_EOF and added a TIMER_DEVICE_CALLBACK function for 
    MCU simulations;
 * Added WIP code for the priority system;
 * Added a NO_DUMP for the MCU for all the sets;

Rewrite of the Motorola DSP56k CPU core. [Andrew Gardner]
 * Partially implemented inc24, asl4, bcc, brkcc, and doForever ops.
 * Added code for parallel address register update.
 * Partially implemented tfr op.
 * Polygonet now allows test mode to be run for a few seconds.  Most 
    IO is now known, though coin2 is still a mystery.
 * Partially implemented move, asr4, and mpy ops.

YM2608/2612: applied latest fixes/discoveries. [Eke-Eke, Nemesis]

Added palette fading effect on macrossp.c driver. [Angelo Salese]

Fixed skewing and display area in MC6845. [Curt Coder]

Fixed Dip Switches and inputs for 'dreamwld'. [stephh]

NEC CPU core improvements: [couriersud]
 * removed another speed hack in the NEC core
 * renamed "FETCH" to "FETCH()" (macros used as functions should 
    look like functions)
 * Preparation for opcode prefetch timing
 * improved prefetch timing calculation
 * prefetch timing now also used by V20 and V33
 * moved some static variables into cpu context
 * nec_reset now explicitly clears context variables
 * all cpus now share nec_execute

More Discrete module optimizations. Added optimized custom mixer to 
Donkey Kong. [Derrick Renaud]

lohtb2: Improved mcu emulation [couriersud]
 * The whole startup cycle now works. No more timeouts and erratic 
    behavior.
 * lohtb2 will however not display the "Warning" screen due to a 
    priority issue. With color/attribute of 0x80 in videoram at 0xd0000 and 0xd8000, videoram at 0xd80000 will be displayed. Some tilemap guru has to look into this.

Fix GCC 4.3 "array bounds exceeded" error in disc_flt.c. [R. Belmont]

plygonet improvements: [R. Belmont]
 - Turned off network IRQ.  Game now boots without "network error"
 - Hooked up palette RAM
 - Improved text layer emulation (flip bits still missing)
 - Fixed text layer emulation and visible area. FBI logo and color 
    test now display properly.

Fixed sound,hooked-up generic inputs and added some notes in Alien 
Command (not yet working). [Angelo Salese]

Fixed m72 tilemap group 2 priorities. [couriersud]

Fixed Joker's Wild graphics to 2 bits per pixel. [Roberto Fresca]

NeoGeo updates [JohnBoy}
 * Updated NeoGeo game pcb infos
 * Renamed p's in kof2000n to correct chip label
 * Renamed v's in mahretsu to correct chip label, readded 128k m1 
    from Mame 0.34b6 / s1 from older dump
 * breakrev: Renamed c's to correct chip label, added correct c5/c6
 * Marked mslug3h MVS AND AES VERSION
 * Marked mslug4 2nd revision, added mslug4 1st revision missing set 
    comment
 * Marked trally MVS AND AES VERSION
 * Marked ncombath MVS AND AES VERSION
 * Marked sengoku MVS VERSION
 * Marked superspy MVS AND AES VERSION
 * Marked mutnat MVS AND AES VERSION

Modified src2html to use a template source file instead of hard-coding 
to the MAME site. Changed from explicit styles to classes. 
[Aaron Giles]

Changed magictg to use (hopefully correct) roms. [David Haywood]

Naomi / DC improvements [Samuele Zannoli]
 * cvs2gd stops looping forever. However with no 3d emulation nothing 
    is shown on the screen.
 * implemented the naomi RTC and there are a few verbose messages
    about transfers not implemented yet.

Fixed Dip Switches for 'exprraid' and clones. [stephh]

Improvements to re900.c driver [Roberto Fresca, Grull Osgo]
 - Reworked inputs to allow 6 players through a selector.
 - Hooked all lamps (even the ball simulator array).
 - Added a internal layout and support for external artwork.
 - Extended the hardware to support Buena Suerte '94.
 - Cleaned up the driver.

Fixed Dip Switches for 'gyruss' and clones. [stephh]

Fix NES APU to work with high sample rates (don't know the bug #).
[Aaron Giles]

Synchronized 6502 disassembly with CPU core. [Pugsy]

Added missing const/statics, added/removed entries in header files, 
and fixed a few potential multisession issues by explicitly adding 
initializers. asic65.c has significant changes to accomodate using a 
struct instead of 16 variables, otherwise the changes are modest and 
obvious. [Atari Ace]

expro02 driver improvements: [Sonikos]
 - Fixed dips in all galsnew sets and  fantasia.
 - Added dips location.
 - A little driver clean up.

Added save state support to the toaplan2 driver. [Atari Ace]

Changed the coinage settings and swapped coin A mech with coin B to
match the behaviour of Chelnov (world) pcb. [Corrado Tomaselli]



New games added or promoted from NOT_WORKING status
---------------------------------------------------
Ruleta RE-900 [Grull Osgo]
Buena Suerte '94 [Grull Osgo, Roberto Fresca]
Virtual Mahjong 2 - My Fair Lady



New clones added
----------------
Power Instinct (USA) [Jim Hernandez]



New games marked as GAME_NOT_WORKING
------------------------------------
Joker's Wild (encrypted) [Roberto Fresca]



0.128u1
-------


MAMETesters Bugs Fixed
----------------------
- 01722: [Crash/Freeze] sokonuke: Game hangs after you choose stage. 
         (Aaron Giles)
- 00468: [DIP/Input] gogomile, gogomilj: Inserting coins or pressing 
         start has no effect at the continue screen. (Phil Bennett)
- 00436: [Sound] kyukaidk: Some of sound effects are wrong. Umpire's 
         voice is most notable. Also, music is not correct. 
         (Phil Bennett)
- 01702: [Gameplay] cloak + clones: Can´t pick up items (Phil Bennett)
- 02140: [Save/Restore] cubeqst: cube quest crashes mame when saving 
         state (Phil Bennett)
- 02577: [DIP/Input] crush and clones: Broken Dips (Fabio Priuli)
- 00359: [Sound] blocken: Some of the enemy voices are totally wrong 
         (Phil Bennett)



Source Changes
--------------
MC6845 changes: [Curt Coder]
 - added cursor and display enable skewing
 - added preliminary support for SY6545-1's transparent addressing mode
 - Hsync should be pulsed even when vsync is active.

Removed per-game hacks from CPS3 (moved to DMA callback in SH2 core).
Removed Speedups from CPS3 / PsikyoSH, while they do still give a 
decent speed boost they're not really needed with the DRC and just 
clutter the code. [David Haywood]

Minor NeoGeo cleanups [JohnBoy]

Rewrite of the Motorola DSP56k CPU core. [Andrew Gardner]
 * Complete rewrite focusing on legibility and extensibility.
 * 27/121 opcodes (mostly) implemented.
 * Bugfix for reset status of interrupt priority bits.
 * Bugfix for disassembly of register-to-register parallel data move.
 * Added additional branch, move and bitfield ops.
 * Plygonet now passes its memory test and uploads a new program.
 * Implemented tst, or, jsr, rti, tst2, and 2 new movec ops.
 * Added opbase handler to plygonet.c

Increase cubeqst interleave factor to eliminate LDP timeout countdown 
flicker. [Philip Bennett]

Added redumped B-Rap Boys sample ROMs. [Guru]

Cleaned up STV rom loading a bit. [David Haywood]

NamcoNBx: fixed C75 BIOS loading for big-endian targets. [R. Belmont]

Updated tnzs.c driver: [stephh]
  - renamed sets :
      * 'tnzsjn'   -> 'tnzsj'
      * 'tnzsj'    -> 'tnzsjo'
      * 'kagekia'  -> 'kagekih'
  - fixed Dip Switches for all games (2 remaining unknown Dips in 
    'plumppop' and 'jpopnics' though)
  - added many notes

Small cleanups to the ST-V driver. Make some work for magzun, still 
not working. [Angelo Salese]

AICA: fix sample addressing for the full 8 MB [kingshriek].

Fixed bnstars1 screens. [David Haywood]

MCS51/I8051 overhaul, micro3d improvements and full m72 protection 
emulation for lohtb2: [couriersud, Jim Stolis]
 * improved serial port timing
 * better infrastructure for adding more variants like DS5002
 * Fixed port reading
 * Rewrote Macros for better readibility
 * Fixed and rewrote Interrupt handling
 * Now returns INTERNAL_DIVIDER, adjusted cycle counts
 * Remove unnecessary and duplicated code
 * Remove unnecessary functions
 * Rewrite to have sfr-registers stored in int_ram. 
 * Debugger may now watch sfr-registers as well.
 * implemented interrupt callbacks (HOLD_LINE now supported)
 * Runtime switch for processor type - remove ifdefs
 * internal memory maps for internal rom versions (internal ram now 
    displayed in debugger)
 * more timer cleanups from manual
 * fix timer 2 interrupts
 * implement serial mode 2/3 rx and tx clock handling
 * Remaining games checked and adapted to changes in cpu core 
 * Cardline still broken. I need the exact and complete cpu name.
 * Added more variants 803X, 80CXX, AT89C4051
 * Fix segas18.c (segaic16.c) mcu maps. 
 * Fix sslam.c 
 * Fix limenko.c videopkr.c : Issue with core allocation of ram (duplicate savestate)

micro3d improvements: [couriersud]
 * serial port communication between main cpu and sound board works
 * sound board now works
 
m72 - lohtb2 improvements: [couriersud]
 * full emulation of protection device
 * Samples are now piped through the mcu

Added sound and corrected wrong DIP-SW in the Double Dealer driver.
Completed protection vectors, fixed video emulation and added coin 
setting simulation. [Angelo Salese]

Fixed recently regressed raster interrupt issues in fuukifg*
drivers. [Philip Bennett]

Added flip screen / cocktail support to yumefude driver. Completed 
DIP-Switches (manual-wise) and made better comments. [Angelo Salese]

Separated umk3 and breakrev from their parents. [David Haywood]

Some reorganization in megadriv.c, porting over some code to attempt 
to get it working again, bit by bit. [David Haywood]

Improved dakkochn gfx; the priority are ok but there are various 
offset so i marked also the game as "inperfect gfx". [Sonikos]

Fixed a subtle bug in the 65c02 emulation where the result of the BIT 
instruction differs on the 65c02 (from the 6502), when executed
in immediate mode. [Phill Harvey-Smith]

Added samples suppor to Cosmic Alien. [T. Bellm]



New games added or promoted from NOT_WORKING status
---------------------------------------------------
(Medal) Yumefuda [Bet] [Angelo Salese]
Grudge Match (Yankee Game Technology) [Aaron Giles]
Double Dealer [Angelo Salese, David Haywood]
Super Megatouch IV (9255-41-07 ROG, New Jersey version) 
  [Mariusz Wojcieszek]
Mirage Youjuu Mahjongden [Angelo Salese]



New clones added
----------------
The King of Fighters 2002 (bootleg) [Kawaks]
Police Trainer (v1.3B Newer) [Brian Troha]
Egg Venture (Release 8) [Brian Troha]
Kick for the Goal [Brian Troha] (Not Working)
Fire Shark (Korea, set 1, easier) [Guru]
Fire Shark (Korea, set 2, harder) [Guru]
Seibu Cup Soccer (set 2) [Chris Hardy] (NOT WORKING)



New games marked as GAME_NOT_WORKING
------------------------------------
P's Attack [Guru]
Magic the Gathering: Armageddon [David Haywood]
