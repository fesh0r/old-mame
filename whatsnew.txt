0.123u2
-------


MAMETesters Bugs Fixed
----------------------
progear0123u1gra [stephh]



Source Changes
--------------
csk.c driver improvements: [Mirko Buffoni]
 * Added DIPLOCATION macros to all Dip Switches. All DSW are verified 
    through test mode.
 * Fixed custom_io_r which is used for protection but also for 
    keyboard input.

Fixed build with external zlib. [R. Belmont]

Completed old-style colortable removal. Removed 
MDRV_COLORTABLE_LENGTH macro. Updated uigfx to display new-style
color tables if present. [Zsolt Vasvari]

Reorganized/minor clean-ups to Mad Alien driver. [Zsolt Vasvari]

Fixed Xenophobe sprite aligment. [Derek Ledbetter]

Converted SNES (except debug code) to RGB32 as it was a serious 
abuser of the palette system. [Zsolt Vasvari]

Added colortable_palette_get_size() to emupal. Added some more 
asserts to catch errors. [Zsolt Vasvari]

Fixed Dip Switches (especially coinage) and inputs for 'mpatrol' and 
'troangl' (and their clones). Tried to "unify" the two drivers (I 
still think that some things can be merged). Added iremipt.h source 
file (same purpose as taitoipt.h). Fixed Dip Switches and inputs for 
'alpha1v'. The game is now more playable to me but I left the 
GAME_NOT_WORKING flag as I think there are still some things to look 
at). [stephh]

Changed IREM cpu decryption to be 'real-time' (it's a feature of the 
CPU). Moved decryption table setup to 'config' struct for the CPU.
Added latest tables from robiza, making Risky Challenge playable, 
promoted it to working. Told CPU core to not decrypt code after 
brkn instruction, enabling it again on iret, allowing me to remove 
several 'don't decrypt range' hacks in the code. Updated all drivers 
accordingly. Currently the disassembly is a bit weird now, this will 
need looking at. [David Haywood, robiza]

Added and hooked up AICA (Naomi sound chip). Naomi boot sounds now 
play. Since it's an SCSPx2 with ADPCM instead of FM it's already 
feature-complete except filter envelopes. A bug in the ARM7 core 
causes incorrect pan/level values to be computed in e.g. the Naomi 
SOUND TEST menu. This is not a defect in the AICA.
[ElSemi, Deunan Knute, kingshriek, R. Belmont]

Fixed Dip Switches (especially coinage) and inputs for '10yard' (and 
its clones). Tried to "unify" the driver with m52 and m57 drivers 
(I still think that some things can be merged). [stephh]

Fixed unaligned 32-bit reads in the ARM7 core. [R. Belmont]

Fixed misaligned backgrounds in mpatrol caused by recent changes.
[Zsolt Vasvari]

Minor code cleanups. Added static/const where appropriate, plus some 
include fixes. Reverted some of the changes to build.mak from u1 
which made some MSVC builds fail, and adjusted/optimized an m10.c 
gfx_layout. Added some missing cores to cpuintrf.c, sndintrf.c and 
added some missing #if's to 5220intf.c. [Atari Ace]

Fixed one or two dips in the mirage.c driver and found the "service" 
switch and likely start of inputs. [Brian Troha]

Removed expand_machine_driver(). Replaced with machine_config_alloc() 
and machine_config_free(). Updated all call sites. Normalized info.c 
style and simplified some of the code. [Aaron Giles]

Renamed machine->drv to machine->config to reduce overloading of the
term "driver". [Aaron Giles]

Simplified collision detection in taitosj and tank8. [Zsolt Vasvari]

New module: devintrf.c/.h. Implements a generic device interface 
similar to the sound and CPU interfaces. [Aaron Giles]

New module: mconfig.c/.h. Moved all machine_config and MDRV_* macros 
here, out of driver.c/.h. Added MDRV macros for adding/removing/
configuring devices. [Aaron Giles]

Deprecated the following constants because global constants that 
pretend to document things but which are only guesses are dumb:
  - DEFAULT_60HZ_VBLANK_DURATION
  - DEFAULT_30HZ_VBLANK_DURATION
  - DEFAULT_REAL_60HZ_VBLANK_DURATION
  - DEFAULT_REAL_30HZ_VBLANK_DURATION
  - DEFAULT_60HZ_3S_VBLANK_WATCHDOG
  - DEFAULT_30HZ_3S_VBLANK_WATCHDOG
Updated all drivers to explicitly specify the equivalent bogus 
times. Added comments for the "REAL" VBLANK durations to indicate 
that they are not accurate. [Aaron Giles]

Improved some DIP switches, added some DIP locations, replaced 
IPT_COINx with IPT_SERVICE1 where appropiate, and simplified some 
control definitions in the following drivers: alpha68k.c, actfancr.c,
aeroboto.c, aerofgt.c, aliens.c, ambush.c, amidar.c, amspdwy.c,
angelkds.c, appoooh.c, arabian.c, argus.c, arkanoid.c. [RansAckeR]

Connected the Shadow Warriors buttons like they are wired on the 
original pcb (which is jamma). [Corrado Tomaselli]

Added DIP locations to: cclimbr2 , legion, terraf, ultennis, cheesech,
stonebal, stoneba2,  scessjoe, ashnojoe, asteroid, llander, llander1,
astdelux. [RansAckeR]

Fixed multi-session crash with Namco System 2 games. [Atari Ace]

Improved Print Club DIP switches. [Edward Swiftwood]

Fixed a few corner cases in the 6840 emulation based on running the 
MPU4 test ROMs, and added the ability to dynamically alter the 
external clock frequencies in game. [James Wallace]

Changed the 6850 core to allow dynamic RX and TX clock alteration, 
to at least try to remove a few of the MPU4 timing problems.
[James Wallace]

Updated documentation of the MPU4 Video board. Added documentation of
the Cosmic Chasm crystals, and merged the memory maps. [James Wallace]

Fixed validation fail of '_mul_32x32_hi()' and '_mulu_32x32_hi()' 
inline function when compiled GCC v3.3.5 with I686 optimization.
[KO Myung-Hun]

Verified clocks on Rainbow Islands and Rambo 3 and Raiden 2. Reverted 
sound OSC of Truxton 2 to 27mhz/8 since the original OST runs at this 
speed. The pcb I measured the previous clock was 28mhz/8 and it's a 
different pcb version from the common one. Since mame doesn't support 
multiple OSC I prefer to use the 27mhz one. [Corrado Tomaselli]

Fixed some incorrect rom dumps for Double Dragon 3 (Some of the dumps 
were based of the bootleg and not the original.) and updated the name 
and location to actually match that of a real board. [Kevin Eshbach]

Added DIP locations to Combatribes and Battletoads. [Kevin Eshbach]

Added video_screen_update_now(int scrnum) to force a screen update up 
to the current beam position. [Zsolt Vasvari]

Pulled remaining vestiges of old-style colortables: [Aaron Giles]
 * PALETTE_INIT no longer has a colortable parameter
 * removed game_colortable and remapped_colortable from machine_config
 * updated a few stragglers that still referenced these fields
 * removed tile_draw_colortable from tilemap.c

Changed the input port tokens to use a union instead of casting 
everything to FPTR. In the future, C99-enabled compilers will be able 
to achieve type safety with designated initializers. [Aaron Giles]

Added i8749 CPU variant for MESS. [Curt Coder]

Added missing SH4 instructions and bugfixed the FPU. Improved Naomi
I/O board emulation and added working controls. [Samuele Zannoli]

jedi.c improvements: [Zsolt Vasvari]
 - Complete memory map
 - Crystals
 - Driver state structure
 - Text layer is rendered at the same time as the background

Reorganized Qix driver (driver state, decoupled audio section, etc.)
[Zsolt Vasvari]

Changed all drivers using the MC6845 chip to use the new device 
interface. Removed mc6845_config. [Zsolt Vasvari]

Reorganized Gameplan driver. Changed Trivia Quest use the Gameplan 
video code. Added crystal for Gameplan pixel clock. [Zsolt Vasvari]

Removed the unnecessary pen array lookup from some INDEXED16 drivers.
[Zsolt Vasvari]

Removed the per-screen palette_base. This was an idea that never
really worked out, nor have we really needed it. [Aaron Giles]

Defined a new device type VIDEO_SCREEN. Currently this has no
live functionality, but merely serves as a placeholder/identifier
for video screens. Eventually some of the screen management code
may move into the start/stop/reset functions. [Aaron Giles]

Changed MDRV_SCREEN_ADD to specify a screen type (RASTER, VECTOR,
LCD for the moment). Removed the older VIDEO_TYPE_RASTER and 
VIDEO_TYPE_VECTOR; this information is now determined by walking 
the screen list. [Aaron Giles]

Changed MDRV_SCREEN_* macros to build up VIDEO_SCREEN devices
rather than storing values in the screen[] array. Removed the 
screen[] array from machine_config. Modified all code referencing 
Machine->config->screen[] and changed it to iterate over the devices 
using the new video_screen_first() and video_screen_next() 
functions. [Aaron Giles]

Removed implicit screen #0. This means that ALL DRIVERS MUST
EXPLICITLY DECLARE THEIR SCREENS. Updated all drivers to do
so. While there, grouped all MDRV_SCREEN_* parameters together.
Also removed unnecessary VIDEO_TYPE_RASTER and VIDEO_TYPE_VECTOR.
Also removed VBLANK and bitmap format information from vector
games. This was painful and very tedious. [Aaron Giles]

Changed game information to display info about all screens. 
[Aaron Giles]

Changed Beathead driver to use partial updates instead of caching 
scanline level information. [Zsolt Vasvari]

Added state_save_combine_module_and_tag(). Its purpose is to create 
a unique name for state saving purposes in modules that are tag 
based (no index). [Zsolt Vasvari]



New games added or promoted from NOT_WORKING status
---------------------------------------------------
Champion Poker [Mirko Buffoni]
Risky Challenge [robiza]



New clones added
----------------
Fighting Soccer (Japan) [Yasuhiro Ogawa]
Red Hawk (Excellent Co., Ltd) [Brian Troha]



New games marked as GAME_NOT_WORKING
------------------------------------
Toy Fighter [Corrado Tomaselli]



0.123u1
-------


MAMETesters Bugs Fixed
----------------------
jantouki0121u3gra [RansAckeR]
mcnpshnt0120u3gra [RansAckeR]
mjdialq2_0120u3gra [RansAckeR]
mjifb0111u2gra [RansAckeR]
goldbug0105u4gra [stephh]
zn.c0122u8yel [smf]
pwrinst2_0122u8gra [Sonikos]



Source Changes
--------------
Removed 'type' parameter from tilemap_create. [Zsolt Vasvari]

audio/dkong.c: [couriersud]
 * fix dkong audio over-modulation issue with DAC sound
 * surround the fix with a DK_REVIEW define for later review.

Changed the use of machine->remapped_colortable to machine->pens where
the drivers weren't using color tables. [Zsolt Vasvari]

Corrected the clocks on the following pcbs: Formation Z, MagMax, 
SlapFight and Tiger Heli. Changed Oki m6295 pin 7 to "high" on Toki 
and Blood Bros. [Corrado Tomaselli]

Improve build independence for CPU/sound cores. Rescued the M65CE02 
core from bitrot hell, and fixed some MESS cores that were broken by 
the deprecat.h changes. [Atari Ace]

Corrected the initial detection of extended INP files. 
[Barry Rodewald]

Moved Galaxy Games emulation to tmaster.c. [Luca Elia]

makefile/build updates: [couriersud, Aaron Giles]
 * moved verinfo.c to src/build
 * moved rules for verinfo to src/build/build.mak
 * removed osdcore.h from file2str.c, verinfo.c, png2bdc.c

Removed color tables from gsword, hyperspt, jailbrek, magmax, 
konamigx, markham, megazone, pandoras, rocnrope, strnskil, trackfld,
tp84, shaolins, scotrsht, pingpong, skykid, wiping, punchout, ikki,
rallyx, fastfred, fcombat, finalizr, flower, funworld, galivan,
gdrawpkr, goldstar, hanaawas, higemaru, ironhors, jackal, kchamp.
Added resnet.c color computations where appropriate. [Zsolt Vasvari]

Simplfied Mag Max background drawing code. [Zsolt Vasvari]

Further altered the Exidy 440 code in preparation for moving to proper
sound chip emulation. [Zsolt Vasvari]

Unified transparency handling between scotrsht, shaolins, tp84.
[Zsolt Vasvari]

Split timer_adjust() into timer_adjust_oneshot() and 
timer_adjust_periodic(). Updated all call sites. [Aaron Giles]

Fixed some arkanoid clones INPUT_PORTS definitions that were curiously 
using PORT_START_TAG("DSW") instead of PORT_MODIFY("DSW"). [stephh]

Fixed DIP switches and inputs for all games in cvs.c. [stephh]

Added HOTD2-specific BIOSes. [Arzeno Fabrice]

Added more accurate emulation of the priority system and the beam
logic in stactics. Removed color table. Centered crosshair. Used
proper game orientation. Unified memory maps. Switched game to use the
artwork system. Set GAME_IMPERFECT_GRAPHICS until artwork is created.
[Zsolt Vasvari]

Added sound support to Champion Skill. Removed GAME_NO_SOUND flags.
Increased interrupts per frame, music was too slow. Minor comments 
adjustment. [Mirko Buffoni]

Used PORT_SERVICE and PORT_SERVICE_NO_TOGGLE macros when it was 
possible. [stephh]

In the cps2 driver, Changed the GAME definitions to reflect how many 
players and how many buttons there are for each game. Rewrote the 
INPUT_PORTS definitions to use PORT_INCLUDE, PORT_MODIFY and 
PORT_CUSTOM macros. Added a few notes about the inputs when I thought 
they were needed to avoid wrong bug reports. Started to clean the 
driver. [stephh]

Added PCB and/or chip docs updates for Blaze On (kaneko16.c),
Sand Scorpion (sandscrp.c), Flash Point (segas16b.c). [Brian Troha]

Fixed kangaroo colors by assuming an inversion not present in the
schematics. [Nicola Salmoria]

Added the ability to pass absolute paths to mame_schedule_save() and 
mame_schedule_load(). [Nathan Woods]

Naomi/DC updates: [Samuele Zannoli]
 - Add SH4 I/O ports
 - Connected the 93C46 of the naomi and the x76f100 of the rom board 
    and filled them with dummy data to satisfy the BIOS
 - Implemented some of the JVS transfers that will be needed to use 
    the controls
 - Implemented ROM board DMA
 - Set proper NAOMI RAM sizes (32 MB main, 8 MB for AICA)
 - Improved PVR-TA graphics emulation

Set proper ARM7 clock for Naomi. [Deunan Knute]

ARM7 updates: [Anonymous]
 - correct mode at reset (it's always 0b1....)
 - HandlePSRTransfer: remove wrong code, correct detection of 
    privileged mode
 - correct carry output for ROR
 - Thumb ASR Rd,Rs: correct carry computation
 - Thumb ldmia/stmia: correct value for writeback when the writeback 
    reg is in the list
 - ARM ldm/stm ignore lower bits of the address
 - most of the exceptions force the I bit
 - ignore some flag bits in the CPSR

Some improvements to the Funworld driver and new games added. 
[Roberto Fresca]
 - Switched to XTAL def.
 - Fixed Magic Card II graphics issues.
 - Fixed Magic Card II inputs.
 - Fixed screen and visible area to snooker10.
 - Renamed set monglfir to mongolnw.
 - Renamed sets description based on languages instead of countries.
 - Fixed some years and manufacturers.
 - Updated technical notes.
 - Cleaned up the driver.
 
Did some cleanup of the 'special case' mess that the rallyx driver
has become. [Zsolt Vasvari]

Removed no longer used TRANSPARENCY_COLOR. [Zsolt Vasvari]

MC6845 updates: [Zsolt Vasvari]
 - changed the 6845 to be handle based -- adjusted all drivers
 - renamed crtc6845 to mc6845
 - allow reading registers 12 and 13
 - reading write-only registers return 0
 - updated comments in header
 
Changed qix.c to RGB32 mode and made its videoram_w do the partial 
updating instead of a per scanline timer. [Zsolt Vasvari]

Fixed 'mario' and 'masao' memory maps to match the Dip Switches port 
name. [stephh]

Fixed pooyan transparency. Updated to use resnet code. [Zsolt Vasvari]

Changed ZN2 clock speed to 100MHz to match board notes. [smf]

Added DIP locations for sitv, sicv, invadpt2, lrescue, invasion. Fixed 
coin2 for superinv & invasion. [RansAckeR]

Added initialization to machine/nmk112.c. This resolves a multi-
session audio problem reported for donpachi. Also added some variable 
initialization to machine/n64.c to fix running starsldr multi-session.
[Atari Ace]

Added diplocations to policetr and marked some as unused based on 
manual and schematics. [Mike Ellery]

Fixed fatal error in the maxaflex, mf_bdash and mf_achas drivers.
[Atari Ace]

Several more risky challenge opcodes. You can now see "gameplay".
[robiza]



New games added or promoted from NOT_WORKING status
---------------------------------------------------
Galaxy Games (BIOS v1.90) [Luca Elia]
Royal Vegas Joker Card [Roberto Fresca]



New clones added
----------------
Contra (US, Set 2) [Brian Troha]
Zero Wing (2 player simultaneous ver.) [Brian Troha]
Sand Scorpion (Revised Hardware) [Stefan Lindberg]
Galaxian (Taito) [Stefan Lindberg]
Jolly Card (3x3 deal) [Roberto Fresca]
Jolly Card Professional 2.0 [Roberto Fresca]
Lucky Lady (3x3 deal) [Roberto Fresca]
Lucky Lady (4x1 aces) [Roberto Fresca]



New games marked as GAME_NOT_WORKING
------------------------------------
World PK Soccer V2 (ver 1.1) [David Haywood]
